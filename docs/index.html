<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Stuy Computational Physics — Demo Gallery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:2rem;max-width:1100px}
    h1{margin:.2rem 0 .4rem}
    .sub{color:#666;margin:.2rem 0 1rem}
    .controls{margin:1rem 0}
    input[type=search]{padding:.6rem .7rem;border:1px solid #ddd;border-radius:12px;min-width:280px}
    .section{margin:1.5rem 0}
    .section h2{font-size:1.1rem;margin:.75rem 0}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
    .card{border:1px solid #ddd;border-radius:12px;padding:14px;background:#fff}
    .card a{font-weight:600;text-decoration:none}
    .path{color:#888;font-size:12px;margin:.25rem 0 0}
    .empty{color:#888;padding:1rem 0}
    footer{margin-top:2rem;color:#888}
    .divider{height:1px;background:#eee;margin:1rem 0}
  </style>
</head>
<body>
  <h1>Stuy Computational Physics — Live Demos</h1>
  <p class="sub">GlowScript/Web VPython exports, organized by folder (same as Python source structure).</p>

  <div class="controls">
    <input id="q" type="search" placeholder="Filter (e.g., celestial, euler, chaos)" />
  </div>

  <div id="content"></div>
  <div id="empty" class="empty" style="display:none">No demos match your filter.</div>

  <footer>
    Source: <a href="https://github.com/Tasnemo/Stuy-Computational-Physics">GitHub</a> •
    Served via GitHub Pages from <code>/docs</code>
  </footer>

<script>
(async () => {
  const owner = "Tasnemo";
  const repo  = "Stuy-Computational-Physics";
  const branch = "main";     // change if your default branch is different
  const root   = "docs/";    // only list HTMLs under docs/

  const host  = document.getElementById('content');
  const empty = document.getElementById('empty');
  const qIn   = document.getElementById('q');

  // Use git trees API (gets all paths in one call)
  const treeURL = `https://api.github.com/repos/${owner}/${repo}/git/trees/${branch}?recursive=1`;
  let tree;
  try {
    const r = await fetch(treeURL);
    if (!r.ok) throw new Error(`GitHub API ${r.status}`);
    const data = await r.json();
    tree = data.tree || [];
  } catch (e) {
    host.innerHTML = `<div class="empty">Couldn’t read repo tree (${e.message}).</div>`;
    return;
  }

  // Keep only docs/**/*.html (ignore index.html)
  const items = tree
    .filter(t => t.type === 'blob' && t.path.startsWith(root) && t.path.toLowerCase().endsWith('.html'))
    .filter(t => t.path.toLowerCase() !== root + 'index.html')
    .map(t => {
      const rel = t.path.slice(root.length);
      const href = './' + rel;
      const parts = rel.split('/');
      const group = parts.length > 1 ? parts[0] : '(root)';
      const name = parts.pop();
      return { group, rel, href, name };
    })
    .sort((a,b) => (a.group.localeCompare(b.group)) || a.rel.localeCompare(b.rel));

  function render() {
    const q = (qIn?.value || '').trim().toLowerCase();
    const filtered = items.filter(it => {
      const hay = `${it.name} ${it.rel} ${it.group}`.toLowerCase();
      return q ? hay.includes(q) : true;
    });

    if (!filtered.length) {
      host.innerHTML = '';
      empty.style.display = 'block';
      return;
    }
    empty.style.display = 'none';

    // Group by folder
    const groups = {};
    for (const it of filtered) (groups[it.group] ||= []).push(it);

    host.innerHTML = Object.keys(groups).sort().map(g => {
      const cards = groups[g].map(it => `
        <div class="card">
          <a href="${it.href}">${it.name.replace(/_/g,' ')}</a>
          <div class="path">${it.rel}</div>
        </div>`).join('');
      return `<div class="section"><h2>${g}</h2><div class="grid">${cards}</div><div class="divider"></div></div>`;
    }).join('');
  }

  if (qIn) qIn.addEventListener('input', render);
  render();
})();
</script>
</body>
</html>
